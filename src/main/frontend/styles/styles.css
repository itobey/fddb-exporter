/*
 * FDDB Exporter - Modern Dark Theme
 * Accent: #4e619b
 *
 * Note: This stylesheet uses Vaadin Web Components (custom elements with vaadin-* prefix)
 * and Lumo design system variables. Lumo is Vaadin's theming system.
 * IDE warnings about "unknown elements" for vaadin-* selectors are expected and can be ignored.
 * These are valid Web Component selectors that work at runtime.
 */

/* ============================================
   CSS Custom Properties & Lumo Overrides
   ============================================ */
html {
    /* Accent color */
    --accent: #4e619b;
    --accent-hover: #5d72b3;
    --accent-active: #3f4e7d;
    --accent-contrast: #ffffff;

    /* Override Lumo primary color with accent */
    --lumo-primary-color: var(--accent);
    --lumo-primary-color-50pct: rgba(78, 97, 155, 0.5);
    --lumo-primary-color-10pct: rgba(78, 97, 155, 0.1);
    --lumo-primary-text-color: var(--accent-contrast);

    /* Deep dark backgrounds */
    --lumo-base-color: #0f0f11;
    --lumo-tint-5pct: rgba(255, 255, 255, 0.03);
    --lumo-tint-10pct: rgba(255, 255, 255, 0.05);
    --lumo-tint-20pct: rgba(255, 255, 255, 0.08);
    --lumo-tint-30pct: rgba(255, 255, 255, 0.12);
    --lumo-tint-40pct: rgba(255, 255, 255, 0.16);
    --lumo-tint-50pct: rgba(255, 255, 255, 0.2);
    --lumo-tint-60pct: rgba(255, 255, 255, 0.25);
    --lumo-tint-70pct: rgba(255, 255, 255, 0.3);
    --lumo-tint-80pct: rgba(255, 255, 255, 0.4);
    --lumo-tint-90pct: rgba(255, 255, 255, 0.5);
    --lumo-tint: #ffffff;

    --lumo-shade-5pct: rgba(0, 0, 0, 0.05);
    --lumo-shade-10pct: rgba(0, 0, 0, 0.1);
    --lumo-shade-20pct: rgba(0, 0, 0, 0.2);
    --lumo-shade-30pct: rgba(0, 0, 0, 0.3);
    --lumo-shade-40pct: rgba(0, 0, 0, 0.4);
    --lumo-shade-50pct: rgba(0, 0, 0, 0.5);
    --lumo-shade-60pct: rgba(0, 0, 0, 0.6);
    --lumo-shade-70pct: rgba(0, 0, 0, 0.7);
    --lumo-shade-80pct: rgba(0, 0, 0, 0.8);
    --lumo-shade-90pct: rgba(0, 0, 0, 0.9);
    --lumo-shade: #000000;

    /* Contrast colors for cards/surfaces */
    --lumo-contrast-5pct: rgba(255, 255, 255, 0.04);
    --lumo-contrast-10pct: rgba(255, 255, 255, 0.06);
    --lumo-contrast-20pct: rgba(255, 255, 255, 0.1);
    --lumo-contrast-30pct: rgba(255, 255, 255, 0.15);
    --lumo-contrast-40pct: rgba(255, 255, 255, 0.2);
    --lumo-contrast-50pct: rgba(255, 255, 255, 0.25);
    --lumo-contrast-60pct: rgba(255, 255, 255, 0.3);
    --lumo-contrast-70pct: rgba(255, 255, 255, 0.4);
    --lumo-contrast-80pct: rgba(255, 255, 255, 0.5);
    --lumo-contrast-90pct: rgba(255, 255, 255, 0.7);
    --lumo-contrast: #ffffff;

    /* Body text color */
    --lumo-body-text-color: rgba(255, 255, 255, 0.87);
    --lumo-secondary-text-color: rgba(255, 255, 255, 0.6);
    --lumo-tertiary-text-color: rgba(255, 255, 255, 0.4);
    --lumo-disabled-text-color: rgba(255, 255, 255, 0.35);

    /* Headers and surfaces */
    --lumo-header-text-color: rgba(255, 255, 255, 0.95);

    /* Flat shadows - minimal elevation */
    --lumo-box-shadow-xs: 0 1px 2px rgba(0, 0, 0, 0.3);
    --lumo-box-shadow-s: 0 1px 3px rgba(0, 0, 0, 0.35), 0 1px 2px rgba(0, 0, 0, 0.2);
    --lumo-box-shadow-m: 0 2px 6px rgba(0, 0, 0, 0.4), 0 1px 3px rgba(0, 0, 0, 0.25);
    --lumo-box-shadow-l: 0 4px 12px rgba(0, 0, 0, 0.45), 0 2px 6px rgba(0, 0, 0, 0.3);
    --lumo-box-shadow-xl: 0 8px 24px rgba(0, 0, 0, 0.5), 0 4px 12px rgba(0, 0, 0, 0.35);

    /* Border radius - flat design */
    --lumo-border-radius-s: 4px;
    --lumo-border-radius-m: 6px;
    --lumo-border-radius-l: 8px;

    /* Spacing scale - 8px base */
    --lumo-space-xs: 4px;
    --lumo-space-s: 8px;
    --lumo-space-m: 16px;
    --lumo-space-l: 24px;
    --lumo-space-xl: 32px;

    /* Card surface color */
    --card-surface: rgba(255, 255, 255, 0.06);
    --card-border: rgba(255, 255, 255, 0.1);
    --card-hover-surface: rgba(255, 255, 255, 0.08);

    /* Transition timing */
    --transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
    --transition-normal: 180ms cubic-bezier(0.4, 0, 0.2, 1);
    --transition-slow: 250ms cubic-bezier(0.4, 0, 0.2, 1);

    /* Mobile horizontal padding - used to keep consistent spacing between cards and viewport edges */
    --mobile-horizontal-padding: 0.5rem;
}

/* ============================================
   Typography
   ============================================ */
body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica', 'Arial', sans-serif;
    font-weight: 400;
    line-height: 1.5;
    color: var(--lumo-body-text-color);
    background-color: var(--lumo-base-color);
}

h1, h2, h3, h4, h5, h6 {
    color: var(--lumo-header-text-color);
    font-weight: 600;
    line-height: 1.3;
}

/* ============================================
   App Header
   ============================================ */
.app-header {
    background: rgba(255, 255, 255, 0.04);
    border-bottom: 1px solid rgba(255, 255, 255, 0.08);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
}

.app-title {
    font-size: clamp(1rem, 5vw, 1.5rem);
    font-weight: 600;
    color: var(--lumo-header-text-color);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

/* Ensure the header center container keeps icon and title on one line and doesn't wrap */
.app-header-center,
vaadin-horizontal-layout.app-header-center {
    display: flex !important;
    flex-direction: row !important;
    align-items: center !important;
    gap: 0.6rem !important; /* same spacing as the icon margin */
    flex-wrap: nowrap !important; /* prevent icon stacking above title */
    justify-content: flex-start !important; /* Align contents to the left within the header center cell */
    justify-self: start !important; /* Override any inline styles from the Java layout that center the element */
    width: 100% !important; /* ensure it fills the grid cell */
}

/* Prevent the icon from shrinking or forcing the title to wrap */
.app-header-center img,
.app-header-center [class~="fddb-app-header-icon"],
vaadin-horizontal-layout.app-header-center img,
vaadin-horizontal-layout.app-header-center [class~="fddb-app-header-icon"] {
    flex: 0 0 auto !important; /* fixed-size, don't shrink */
    display: inline-block !important;
    vertical-align: middle !important;
}

/* Allow the title to shrink and ellipsize inside the flex container */
.app-header-center .app-title,
vaadin-horizontal-layout.app-header-center .app-title {
    flex: 1 1 auto !important;
    min-width: 0 !important; /* allow flex children to shrink below content width */
    white-space: nowrap !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
    text-align: left !important; /* ensure title text is left-aligned */
}

/* Header and drawer icon handling
   - .fddb-app-header-icon: shown on desktop and mobile (always visible)
   - .fddb-drawer-icon: shown on mobile (hidden on desktop to avoid duplication)
*/
/* Strong selectors to catch the actual DOM element (img, vaadin-image, or any host with the class) */
.app-header [class~="fddb-app-header-icon"],
[class~="fddb-app-header-icon"],
img.fddb-app-header-icon,
vaadin-image.fddb-app-header-icon {
    /* visible by default on mobile and desktop */
    display: inline-block !important;
    visibility: visible !important;
    width: 32px !important;
    height: 32px !important;
    margin-right: 0.6rem !important; /* keep the margin you liked */
    object-fit: contain !important;
}

.fddb-drawer-icon {
    display: inline-block; /* visible by default (mobile) */
}

/* Target the center header container's image specifically as a reliable selector */
.app-header-center img,
.app-header-center [class~="fddb-app-header-icon"],
.app-header-center img.fddb-app-header-icon {
    display: inline-block !important;
    visibility: visible !important;
    width: 32px !important;
    height: 32px !important;
    margin-right: 0.6rem !important;
    object-fit: contain !important;
}

@media (min-width: 769px) {
    .app-header-center img,
    .app-header-center [class~="fddb-app-header-icon"],
    .app-header-center img.fddb-app-header-icon {
        /* same rules for desktop (redundant but explicit) */
        display: inline-block !important;
        visibility: visible !important;
        width: 32px !important;
        height: 32px !important;
        margin-right: 0.6rem !important;
        object-fit: contain !important;
    }
}

/* Desktop breakpoint: show header icon and hide drawer icon
   Use min-width: 769px (this project uses 769px in several places) to avoid overlap. */
@media (min-width: 769px) {
    .app-header [class~="fddb-app-header-icon"],
    img.fddb-app-header-icon,
    vaadin-image.fddb-app-header-icon,
    [class~="fddb-app-header-icon"] {
        display: inline-block !important;
        visibility: visible !important;
        width: 32px !important;
        height: 32px !important;
        margin-right: 0.6rem !important; /* small margin between icon and title on desktop */
        object-fit: contain !important;
    }

    .fddb-drawer-icon {
        display: none !important;
    }
}

/* Fallback: ensure images inside the header are visible (mobile & desktop)
   This prevents previous catch-all hide rules from keeping the icon hidden. */
.app-header img {
    display: inline-block !important;
    visibility: visible !important;
    width: 32px !important;
    height: 32px !important;
    margin-right: 0.6rem !important;
    object-fit: contain !important;
}

@media (min-width: 769px) {
    .app-header img {
        display: inline-block !important;
        visibility: visible !important;
        width: 32px !important;
        height: 32px !important;
        margin-right: 0.6rem !important;
        object-fit: contain !important;
    }
}

/* ============================================
   Drawer / Side Navigation
   ============================================ */
vaadin-side-nav-item {
    --_lumo-item-selected-background: rgba(78, 97, 155, 0.15);
    border-radius: var(--lumo-border-radius-m);
    margin: 2px 0;
    transition: background-color var(--transition-fast);
}

vaadin-side-nav-item::part(link) {
    border-radius: var(--lumo-border-radius-m);
    padding: 8px 12px;
}

vaadin-side-nav-item:hover {
    background-color: rgba(255, 255, 255, 0.06);
}

vaadin-side-nav-item[selected] {
    background: var(--_lumo-item-selected-background);
    border-left: 4px solid var(--accent);
    padding-left: 8px;
}

vaadin-side-nav-item[selected]::part(link) {
    color: var(--accent-contrast);
    font-weight: 500;
}

/* ============================================
   Cards Grid
   ============================================ */
.cards-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
    gap: 16px;
    width: 100%;
}

/* Responsive breakpoints */
@media (max-width: 600px) {
    .cards-grid {
        grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
        gap: 12px;
    }
}

@media (min-width: 1200px) {
    .cards-grid {
        gap: 20px;
    }
}

/* ============================================
   Card Component
   ============================================ */
.card {
    background: var(--card-surface);
    border: 1px solid var(--card-border);
    border-radius: var(--lumo-border-radius-l);
    padding: 16px;
    transition: transform var(--transition-normal),
    box-shadow var(--transition-normal),
    background-color var(--transition-fast);
    box-shadow: var(--lumo-box-shadow-xs);
    box-sizing: border-box;
}

.card:hover {
    transform: translateY(-4px);
    box-shadow: var(--lumo-box-shadow-m);
    background: var(--card-hover-surface);
}

/* Highlighted card (for highest values) */
.card--highlight {
    cursor: pointer;
}

.card--highlight:hover {
    transform: translateY(-6px);
    box-shadow: 0 6px 16px rgba(78, 97, 155, 0.3),
    0 2px 8px rgba(0, 0, 0, 0.4);
}

.card--highlight .card__value {
    color: var(--accent-hover);
}

/* ============================================
   Buttons
   ============================================ */
vaadin-button[theme~="primary"] {
    background: var(--accent);
    color: var(--accent-contrast);
    border-radius: var(--lumo-border-radius-m);
    font-weight: 500;
    transition: background-color var(--transition-fast),
    transform var(--transition-fast);
    box-shadow: var(--lumo-box-shadow-xs);
}

vaadin-button[theme~="primary"]:hover {
    background: var(--accent-hover);
    transform: translateY(-1px);
    box-shadow: var(--lumo-box-shadow-s);
}

vaadin-button[theme~="primary"]:active {
    background: var(--accent-active);
    transform: translateY(0);
    box-shadow: none;
}

vaadin-button {
    border-radius: var(--lumo-border-radius-m);
    transition: all var(--transition-fast);
}

/* ============================================
   Date Badges & Small Labels
   ============================================ */
.date-badge {
    display: inline-block;
    padding: 4px 10px;
    border-radius: 12px;
    background: rgba(78, 97, 155, 0.12);
    color: var(--lumo-body-text-color);
    font-size: 0.75rem;
    font-weight: 500;
    letter-spacing: 0.3px;
}

.label-small {
    font-size: 0.75rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    font-weight: 600;
    color: var(--lumo-secondary-text-color);
}

/* ============================================
   Form Elements
   ============================================ */
vaadin-text-field,
vaadin-text-area,
vaadin-date-picker,
vaadin-integer-field,
vaadin-select {
    --lumo-contrast-10pct: rgba(255, 255, 255, 0.08);
}

vaadin-text-field::part(input-field),
vaadin-text-area::part(input-field),
vaadin-date-picker::part(input-field),
vaadin-integer-field::part(input-field) {
    background: rgba(255, 255, 255, 0.04);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: var(--lumo-border-radius-m);
    transition: border-color var(--transition-fast),
    background-color var(--transition-fast);
}

vaadin-text-field:hover::part(input-field),
vaadin-text-area:hover::part(input-field),
vaadin-date-picker:hover::part(input-field),
vaadin-integer-field:hover::part(input-field) {
    background: rgba(255, 255, 255, 0.06);
    border-color: rgba(255, 255, 255, 0.15);
}

vaadin-text-field[focused]::part(input-field),
vaadin-text-area[focused]::part(input-field),
vaadin-date-picker[focused]::part(input-field),
vaadin-integer-field[focused]::part(input-field) {
    border-color: var(--accent);
    background: rgba(255, 255, 255, 0.08);
    box-shadow: 0 0 0 2px rgba(78, 97, 155, 0.2);
}

/* ============================================
   Notifications
   ============================================ */
vaadin-notification-card {
    display: inline-flex;
    align-items: center;
    width: auto !important;
    max-width: min(90vw, 640px);
    padding: 0 !important; /* removed padding for debugging */
    box-sizing: border-box;
    border-radius: var(--lumo-border-radius-l);
    box-shadow: none !important;
}

/* Prevent children from stretching to fill the notification's flex container */
vaadin-notification-card > * {
    flex: 0 0 auto !important;
}

vaadin-notification-card::before,
vaadin-notification-card::after {
    box-shadow: none !important;
}

vaadin-notification-card[theme~="success"] {
    background: rgba(76, 175, 80, 0.15);
    /* removed border-left to avoid extra colored bar */
    box-shadow: none !important;
}

vaadin-notification-card[theme~="error"] {
    background: rgba(244, 67, 54, 0.15);
    /* removed border-left to avoid extra colored bar */
    box-shadow: none !important;
}

vaadin-notification-card[theme~="warning"] {
    background: rgba(255, 152, 0, 0.15);
    /* removed border-left to avoid extra colored bar */
    box-shadow: none !important;
}

/* Remove any potential overlay shadows */
vaadin-notification-container {
    box-shadow: none !important;
}

vaadin-notification-card * {
    box-shadow: none !important;
}

/* ============================================
   Charts & Visualizations
   ============================================ */
.chart-container {
    background: var(--card-surface);
    border: 1px solid var(--card-border);
    border-radius: var(--lumo-border-radius-l);
    padding: 20px;
    box-shadow: var(--lumo-box-shadow-xs);
}

/* ============================================
   Utility Classes
   ============================================ */
.text-accent {
    color: var(--accent) !important;
}

.bg-accent {
    background-color: var(--accent) !important;
}

.bg-accent-subtle {
    background-color: rgba(78, 97, 155, 0.12) !important;
}

.border-accent {
    border-color: var(--accent) !important;
}

.surface-elevated {
    background: rgba(255, 255, 255, 0.08);
    border: 1px solid rgba(255, 255, 255, 0.12);
}

/* ============================================
   Accessibility - Reduced Motion
   ============================================ */
@media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
    }

    .card:hover,
    .card--highlight:hover,
    vaadin-button:hover {
        transform: none !important;
    }
}

/* ============================================
   Scrollbar Styling
   ============================================ */
::-webkit-scrollbar {
    width: 10px;
    height: 10px;
}

::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.03);
}

::-webkit-scrollbar-thumb {
    background: rgba(255, 255, 255, 0.15);
    border-radius: 5px;
}

::-webkit-scrollbar-thumb:hover {
    background: rgba(255, 255, 255, 0.25);
}

/* ============================================
   Drawer Styling
   ============================================ */
vaadin-app-layout::part(drawer) {
    /* Use solid background instead of transparent for better readability on mobile */
    background: var(--lumo-base-color);
    border-right: 1px solid rgba(255, 255, 255, 0.08);
    /* Ensure drawer has solid background on mobile */
    backdrop-filter: none;
}

/* Hide the drawer header (app icon + label) on desktop and show only on mobile.
   The drawer header is a vaadin-horizontal-layout element with the class `drawer-header`
   and the attribute `slot="drawer"`. Previous selector targeted a child; update it
   to target the element itself to match the DOM produced by `MainLayout.java`.
*/
@media (min-width: 769px) {
    /* Target the host element directly: vaadin-horizontal-layout.drawer-header[slot="drawer"] */
    vaadin-horizontal-layout.drawer-header[slot="drawer"] {
        display: none !important;
    }

    /* Hide the host element and its direct children explicitly */
    vaadin-app-layout > vaadin-horizontal-layout.drawer-header[slot="drawer"],
    vaadin-horizontal-layout.drawer-header[slot="drawer"],
    vaadin-horizontal-layout.drawer-header[slot="drawer"] img,
    vaadin-horizontal-layout.drawer-header[slot="drawer"] h3 {
        display: none !important;
        visibility: hidden !important;
        height: 0 !important;
        padding: 0 !important;
        margin: 0 !important;
        border: 0 !important;
    }
}

@media (max-width: 768px) {
    /* Ensure the drawer header remains a visible flex row on mobile */
    vaadin-horizontal-layout.drawer-header[slot="drawer"] {
        display: flex !important;
        align-items: center !important;
        gap: 0.5rem !important;
    }

    vaadin-app-layout > vaadin-horizontal-layout.drawer-header[slot="drawer"],
    vaadin-horizontal-layout.drawer-header[slot="drawer"] {
        display: flex !important;
        visibility: visible !important;
        height: auto !important;
        padding: 0.75rem 1rem !important;
        margin-bottom: 0.5rem !important;
        border-bottom: 1px solid rgba(255, 255, 255, 0.08) !important;
        align-items: center !important;
        gap: 0.5rem !important;
    }

    /* Card container styles */
    .cards-container {
        width: 100%;
        padding: 0.5rem;
    }

    /* Mobile data card styles */
    .mobile-data-card {
        width: 100%;
        box-sizing: border-box;
    }

    /* Ensure amount and date appear inline next to each other on mobile cards */
    .mobile-data-card .amount-date-row {
        display: inline-flex !important;
        align-items: center !important;
        gap: 8px !important;
        justify-content: flex-start !important;
        width: 100%;
    }

    .mobile-data-card .product-amount {
        display: inline-block !important;
        margin: 0 !important;
        color: var(--lumo-secondary-text-color) !important;
    }

    .mobile-data-card .product-date-badge {
        display: inline-block !important;
        margin-left: 4px !important;
        vertical-align: middle !important;
    }

    /* Enhanced hover effect for clickable cards */
    .mobile-data-card[style*="cursor: pointer"]:hover,
    .mobile-data-card:hover {
        background: var(--card-hover-surface) !important;
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15) !important;
    }

    /* Active/tap state for better mobile feedback */
    .mobile-data-card[style*="cursor: pointer"]:active,
    .mobile-data-card:active {
        transform: translateY(0);
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1) !important;
    }

    /* Mobile-only layout tweaks */
    .mobile-only {
        display: flex !important;
    }

    /* Active/tap state for better mobile feedback */
    .mobile-data-card[style*="cursor: pointer"]:active,
    .mobile-data-card:active {
        transform: translateY(0);
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1) !important;
    }

    /* Ensure amount/date row spacing */
    .mobile-data-card .amount-date-row {
        gap: 8px !important;
    }

    /* Active/tap state duplication handled above */
    /* Ensure cards have spacing - use padding for symmetric spacing instead of asymmetric margins */
    .card, .cards-grid, .cards-container {
        padding-left: var(--mobile-horizontal-padding);
        padding-right: var(--mobile-horizontal-padding);
        margin-left: 0;
        margin-right: 0;
        box-sizing: border-box;
        max-width: 100vw;
        /* Remove max-height on mobile to show all entries without scrolling */
        max-height: none !important;
        /* Use a modest min-height so cards remain usable on touch devices without becoming overly tall */
        min-height: 120px;
    }

    /* Add padding to search forms and buttons on mobile so they're not flush against edges */
    .data-query-tab-layout > vaadin-horizontal-layout,
    .data-query-tab-layout > vaadin-button {
        margin-left: var(--mobile-horizontal-padding);
        margin-right: var(--mobile-horizontal-padding);
    }

    /* Also ensure count labels have consistent margins */
    .data-query-tab-layout > span {
        margin-left: var(--mobile-horizontal-padding);
        margin-right: var(--mobile-horizontal-padding);
    }

    /* Remove padding from data query view tab content layouts on mobile */
    .data-query-view vaadin-tabsheet vaadin-scroller vaadin-vertical-layout {
        padding-left: 0 !important;
        padding-right: 0 !important;
    }
}

/* Extra small devices (phones in portrait, less than 576px) */
@media (max-width: 576px) {
    /* Further reduce spacing - lower the variable so all uses adjust */
    :root {
        --mobile-horizontal-padding: 0.25rem;
    }

    .dashboard-view,
    .data-query-view,
    .rolling-averages-view,
    .data-export-view,
    .correlation-view,
    .migration-view {
        padding: var(--mobile-horizontal-padding) !important;
    }

    /* Stack all horizontal layouts */
    vaadin-horizontal-layout {
        flex-direction: column !important;
    }

    /* Keep our amount-date-row as a row even on the smallest screens */
    vaadin-horizontal-layout.amount-date-row,
    .mobile-data-card .amount-date-row {
        flex-direction: row !important;
        flex-wrap: nowrap !important;
        justify-content: flex-start !important;
        align-items: center !important;
        white-space: nowrap !important;
    }

    /* Full width buttons */
    vaadin-button {
        width: 100%;
        margin: 0.25rem 0;
    }

    /* Smaller cards */
    [class*="card"] {
        min-width: 100px !important;
        font-size: 0.875rem;
    }

    /* Grid - Show fewer columns */
    vaadin-grid::part(cell) {
        font-size: 0.75rem;
        padding: 0.25rem;
    }

    /* Better touch targets */
    vaadin-button,
    vaadin-tab,
    a {
        min-height: 44px;
        min-width: 44px;
    }

    /* Ensure the mobile-only yesterday box has no bottom margin on very small screens */
    .mobile-yesterday-box {
        margin-bottom: 0 !important;
    }
}

/* ============================================
   Mobile Spacing & Safe Areas
   ============================================ */
/* Add safe spacing on mobile to prevent content from touching edges */
@media (max-width: 768px) {
    /* Main content area */
    vaadin-app-layout [slot="drawer"] {
        padding: env(safe-area-inset-top, 0) env(safe-area-inset-right, 0) env(safe-area-inset-bottom, 0) env(safe-area-inset-left, 0);
    }

    /* Add minimum padding to all views on mobile */
    vaadin-vertical-layout:not([theme~="padding-false"]) {
        /* Use the shared mobile padding and respect safe-area insets */
        padding-left: max(var(--mobile-horizontal-padding), env(safe-area-inset-left, 0)) !important;
        padding-right: max(var(--mobile-horizontal-padding), env(safe-area-inset-right, 0)) !important;
        padding-top: max(0.5rem, env(safe-area-inset-top, 0.5rem)) !important;
        padding-bottom: max(0.5rem, env(safe-area-inset-bottom, 0.5rem)) !important;
    }

    /* Ensure H2 headings have spacing from edges */
    h2, h3 {
        padding-left: 0.25rem;
        padding-right: 0.25rem;
    }

    /* Ensure cards have spacing - use padding for symmetric spacing instead of asymmetric margins */
    .card, .cards-grid, .cards-container {
        padding-left: var(--mobile-horizontal-padding);
        padding-right: var(--mobile-horizontal-padding);
        margin-left: 0;
        margin-right: 0;
        box-sizing: border-box;
        max-width: 100vw;
        /* Remove max-height on mobile to show all entries without scrolling */
        max-height: none !important;
        /* Use a modest min-height so cards remain usable on touch devices without becoming overly tall */
        min-height: 120px;
    }

    /* Add padding to search forms and buttons on mobile so they're not flush against edges */
    .data-query-tab-layout > vaadin-horizontal-layout,
    .data-query-tab-layout > vaadin-button {
        margin-left: var(--mobile-horizontal-padding);
        margin-right: var(--mobile-horizontal-padding);
    }

    /* Also ensure count labels have consistent margins */
    .data-query-tab-layout > span {
        margin-left: var(--mobile-horizontal-padding);
        margin-right: var(--mobile-horizontal-padding);
    }

    /* Remove padding from data query view tab content layouts on mobile */
    .data-query-view vaadin-tabsheet vaadin-scroller vaadin-vertical-layout {
        padding-left: 0 !important;
        padding-right: 0 !important;
    }
}

/* Extra small devices (phones in portrait, less than 576px) */
@media (max-width: 576px) {
    /* Further reduce spacing - lower the variable so all uses adjust */
    :root {
        --mobile-horizontal-padding: 0.25rem;
    }

    .dashboard-view,
    .data-query-view,
    .rolling-averages-view,
    .data-export-view,
    .correlation-view,
    .migration-view {
        padding: var(--mobile-horizontal-padding) !important;
    }

    /* Stack all horizontal layouts */
    vaadin-horizontal-layout {
        flex-direction: column !important;
    }

    /* Keep our amount-date-row as a row even on the smallest screens */
    vaadin-horizontal-layout.amount-date-row,
    .mobile-data-card .amount-date-row {
        flex-direction: row !important;
        flex-wrap: nowrap !important;
        justify-content: flex-start !important;
        align-items: center !important;
        white-space: nowrap !important;
    }

    /* Full width buttons */
    vaadin-button {
        width: 100%;
        margin: 0.25rem 0;
    }

    /* Smaller cards */
    [class*="card"] {
        min-width: 100px !important;
        font-size: 0.875rem;
    }

    /* Grid - Show fewer columns */
    vaadin-grid::part(cell) {
        font-size: 0.75rem;
        padding: 0.25rem;
    }

    /* Better touch targets */
    vaadin-button,
    vaadin-tab,
    a {
        min-height: 44px;
        min-width: 44px;
    }

    /* Ensure the mobile-only yesterday box has no bottom margin on very small screens */
    .mobile-yesterday-box {
        margin-bottom: 0 !important;
    }
}

/* ============================================
   Project-specific responsive tweaks
   ============================================ */

/* Compact preset buttons used in RollingAveragesView */
.preset-btn {
    padding: 0.45rem 0.7rem;
    font-size: 0.95rem;
    box-sizing: border-box;
}

/* Drawer header small padding tweak (MainLayout drawer header) */
.drawer-header {
    padding-left: 1rem !important;
    padding-right: 1rem !important;
    /* Top slightly smaller than bottom for visual balance when icon shown */
    padding-top: 0.75rem !important;
    padding-bottom: 1rem !important;
    display: flex;
    align-items: center;
}

/* Ensure the app icon in the drawer header is sized and spaced */
.drawer-header img {
    width: 32px;
    height: 32px;
    object-fit: contain;
    margin-right: 0.5rem;
}

/* Ensure the header text aligns vertically */
.drawer-header h3 {
    margin: 0;
    line-height: 1;
}

/* Place desktop-hide rules after the .drawer-header declaration so they win in cascade.
   Hide the entire drawer header (icon + label) on desktop, show on mobile. */
@media (min-width: 769px) {
    /* Hide the host element and its direct children explicitly */
    vaadin-app-layout > vaadin-horizontal-layout.drawer-header[slot="drawer"],
    vaadin-horizontal-layout.drawer-header[slot="drawer"],
    vaadin-horizontal-layout.drawer-header[slot="drawer"] img,
    vaadin-horizontal-layout.drawer-header[slot="drawer"] h3 {
        display: none !important;
        visibility: hidden !important;
        height: 0 !important;
        padding: 0 !important;
        margin: 0 !important;
        border: 0 !important;
    }
}

@media (max-width: 768px) {
    vaadin-app-layout > vaadin-horizontal-layout.drawer-header[slot="drawer"],
    vaadin-horizontal-layout.drawer-header[slot="drawer"] {
        display: flex !important;
        visibility: visible !important;
        height: auto !important;
        padding: 0.75rem 1rem !important;
        margin-bottom: 0.5rem !important;
        border-bottom: 1px solid rgba(255, 255, 255, 0.08) !important;
        align-items: center !important;
        gap: 0.5rem !important;
    }
}

/* Final override: specifically target the actual DOM element seen in the browser
   (an element with slot="drawer" and class="drawer-header"). Put this at the
   very end so it takes precedence. */
@media (min-width: 769px) {
    /* Match both generic slotted node and the vaadin-horizontal-layout tag */
    [slot="drawer"].drawer-header,
    vaadin-horizontal-layout.drawer-header[slot="drawer"] {
        display: none !important;
        visibility: hidden !important;
        height: 0 !important;
        padding: 0 !important;
        margin: 0 !important;
        border: 0 !important;
        overflow: hidden !important;
    }
}

@media (max-width: 768px) {
    [slot="drawer"].drawer-header,
    vaadin-horizontal-layout.drawer-header[slot="drawer"] {
        display: flex !important;
        visibility: visible !important;
        height: auto !important;
        padding: 0.75rem 1rem !important;
        margin-bottom: 0.5rem !important;
        border-bottom: 1px solid rgba(255, 255, 255, 0.08) !important;
        align-items: center !important;
        gap: 0.5rem !important;
    }
}

